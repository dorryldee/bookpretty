{% extends "base.html" %}
{% load static %}
{% block title %}Client Details{% endblock %}
{% block content %}
<section class="p-3">
  <div class="container">
    <div class="d-flex justify-content-between align-items-start">
      <div>
        <h2>{{ client.first_name }} {{ client.last_name }}</h2>
        <p><strong>Email:</strong> {{ client.email }}</p>
        <p><strong>Phone:</strong> {{ client.phone }}</p>
        <p><strong>Address:</strong> {{ client.address }}</p>
        <p><strong>Notes:</strong> {{ client.notes }}</p>
      </div>
      <div class="text-end">
        {% if client.status == client.STATUS_PENDING %}
          <span class="badge bg-warning text-dark">Pending</span>
        {% elif client.status == client.STATUS_APPROVED %}
          <span class="badge bg-success">Approved</span>
        {% else %}
          <span class="badge bg-danger">Rejected</span>
        {% endif %}
        <p class="mt-2"><small>Created: {{ client.created_at|date:"Y-m-d H:i" }}</small></p>
        {% if client.reviewed_by %}
          <p><small>Reviewed by: {{ client.reviewed_by }} at {{ client.reviewed_at|date:"Y-m-d H:i" }}</small></p>
          {% if client.review_notes %}
            <p><strong>Review notes:</strong> {{ client.review_notes }}</p>
          {% endif %}
        {% endif %}
      </div>
    </div>

    <div class="mt-3">
      <a class="btn btn-outline-primary" href="{% url 'edit' client.pk %}">Edit</a>

      <form method="post" action="{% url 'approve' client.pk %}" style="display:inline-block; margin-left:6px;">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">
        {{ review_form.review_notes }}
        <button type="submit" class="btn btn-success mt-1" {% if client.status == client.STATUS_APPROVED %}disabled{% endif %}>Approve</button>
      </form>

      <form method="post" action="{% url 'reject' client.pk %}" style="display:inline-block; margin-left:6px;">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">
        <button type="submit" class="btn btn-danger mt-1" {% if client.status == client.STATUS_REJECTED %}disabled{% endif %}>Reject</button>
      </form>

      <a class="btn btn-outline-secondary ms-2" href="{% url 'list' %}">Back to list</a>
    </div>
  </div>
</section>
{% endblock %}